!function(e,t,r,s,n,o,a,i){var l="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},h="function"==typeof l[s]&&l[s],u=h.i||{},d=h.cache||{},c="undefined"!=typeof module&&"function"==typeof module.require&&module.require.bind(module);function p(t,r){if(!d[t]){if(!e[t]){if(n[t])return n[t];var o="function"==typeof l[s]&&l[s];if(!r&&o)return o(t,!0);if(h)return h(t,!0);if(c&&"string"==typeof t)return c(t);var a=Error("Cannot find module '"+t+"'");throw a.code="MODULE_NOT_FOUND",a}u.resolve=function(r){var s=e[t][1][r];return null!=s?s:r},u.cache={};var i=d[t]=new p.Module(t);e[t][0].call(i.exports,u,i,i.exports,l)}return d[t].exports;function u(e){var t=u.resolve(e);return!1===t?{}:p(t)}}p.isParcelRequire=!0,p.Module=function(e){this.id=e,this.bundle=p,this.require=c,this.exports={}},p.modules=e,p.cache=d,p.parent=h,p.distDir=void 0,p.publicUrl=void 0,p.devServer=void 0,p.i=u,p.register=function(t,r){e[t]=[function(e,t){t.exports=r},{}]},Object.defineProperty(p,"root",{get:function(){return l[s]}}),l[s]=p;for(var f=0;f<t.length;f++)p(t[f]);if(r){var m=p(r);"object"==typeof exports&&"undefined"!=typeof module?module.exports=m:"function"==typeof define&&define.amd&&define(function(){return m})}}({dDS2A:[function(e,t,r,s){e("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(r);var n=e("hono"),o=e("./endpoints/users/index.ts");let a=new(0,n.Hono);a.onError((e,t)=>(console.error(`${e}`),t.text("Error from Hono",500))),a.notFound(e=>{console.log("Hono notFound",e.req.url);let t=new URL("404.html",e.req.url);return e.env.ASSETS.fetch(t)}),a.use(async(e,t)=>{console.log("Hono before",e.req.url),await t(),console.log("Hono after",e.req.url)}),a.get("/api",e=>e.text(`Hello Cloudflare Workers! ${o.FOO}`)),a.get("/test",e=>e.text("Hono!")),r.default=a},{hono:"dpYm7","./endpoints/users/index.ts":"6Gli9","@parcel/transformer-js/src/esmodule-helpers.js":"dt6k9"}],dpYm7:[function(e,t,r,s){var n=e("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(r),n.export(r,"Hono",()=>o.Hono);var o=e("./hono.js")},{"./hono.js":"3ehAE","@parcel/transformer-js/src/esmodule-helpers.js":"dt6k9"}],"3ehAE":[function(e,t,r,s){var n=e("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(r),n.export(r,"Hono",()=>h);var o=e("./hono-base.js"),a=e("./router/reg-exp-router/index.js"),i=e("./router/smart-router/index.js"),l=e("./router/trie-router/index.js"),h=class extends o.HonoBase{constructor(e={}){super(e),this.router=e.router??new(0,i.SmartRouter)({routers:[new(0,a.RegExpRouter),new(0,l.TrieRouter)]})}}},{"./hono-base.js":"cubCA","./router/reg-exp-router/index.js":"g63tS","./router/smart-router/index.js":"7xsbc","./router/trie-router/index.js":"3vG3W","@parcel/transformer-js/src/esmodule-helpers.js":"dt6k9"}],cubCA:[function(e,t,r,s){var n=e("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(r),n.export(r,"HonoBase",()=>c);var o=e("./compose.js"),a=e("./context.js"),i=e("./router.js"),l=e("./utils/constants.js"),h=e("./utils/url.js"),u=e=>e.text("404 Not Found",404),d=(e,t)=>{if("getResponse"in e){let r=e.getResponse();return t.newResponse(r.body,r)}return console.error(e),t.text("Internal Server Error",500)},c=class{get;post;put;delete;options;patch;all;on;use;router;getPath;_basePath="/";#e="/";routes=[];constructor(e={}){[...i.METHODS,i.METHOD_NAME_ALL_LOWERCASE].forEach(e=>{this[e]=(t,...r)=>("string"==typeof t?this.#e=t:this.#t(e,this.#e,t),r.forEach(t=>{this.#t(e,this.#e,t)}),this)}),this.on=(e,t,...r)=>{for(let s of[t].flat())for(let t of(this.#e=s,[e].flat()))r.map(e=>{this.#t(t.toUpperCase(),this.#e,e)});return this},this.use=(e,...t)=>("string"==typeof e?this.#e=e:(this.#e="*",t.unshift(e)),t.forEach(e=>{this.#t(i.METHOD_NAME_ALL,this.#e,e)}),this);let{strict:t,...r}=e;Object.assign(this,r),this.getPath=t??!0?e.getPath??h.getPath:h.getPathNoStrict}#r(){let e=new c({router:this.router,getPath:this.getPath});return e.errorHandler=this.errorHandler,e.#s=this.#s,e.routes=this.routes,e}#s=u;errorHandler=d;route(e,t){let r=this.basePath(e);return t.routes.map(e=>{let s;t.errorHandler===d?s=e.handler:(s=async(r,s)=>(await (0,o.compose)([],t.errorHandler)(r,()=>e.handler(r,s))).res)[l.COMPOSED_HANDLER]=e.handler,r.#t(e.method,e.path,s)}),this}basePath(e){let t=this.#r();return t._basePath=(0,h.mergePath)(this._basePath,e),t}onError=e=>(this.errorHandler=e,this);notFound=e=>(this.#s=e,this);mount(e,t,r){let s,n;r&&("function"==typeof r?n=r:(n=r.optionHandler,s=!1===r.replaceRequest?e=>e:r.replaceRequest));let o=n?e=>{let t=n(e);return Array.isArray(t)?t:[t]}:e=>{let t;try{t=e.executionCtx}catch{}return[e.env,t]};s||=(()=>{let t=(0,h.mergePath)(this._basePath,e),r="/"===t?0:t.length;return e=>{let t=new URL(e.url);return t.pathname=t.pathname.slice(r)||"/",new Request(t,e)}})();let a=async(e,r)=>{let n=await t(s(e.req.raw),...o(e));if(n)return n;await r()};return this.#t(i.METHOD_NAME_ALL,(0,h.mergePath)(e,"*"),a),this}#t(e,t,r){e=e.toUpperCase();let s={path:t=(0,h.mergePath)(this._basePath,t),method:e,handler:r};this.router.add(e,t,[r,s]),this.routes.push(s)}#n(e,t){if(e instanceof Error)return this.errorHandler(e,t);throw e}#o(e,t,r,s){if("HEAD"===s)return(async()=>new Response(null,await this.#o(e,t,r,"GET")))();let n=this.getPath(e,{env:r}),i=this.router.match(s,n),l=new(0,a.Context)(e,{path:n,matchResult:i,env:r,executionCtx:t,notFoundHandler:this.#s});if(1===i[0].length){let e;try{e=i[0][0][0][0](l,async()=>{l.res=await this.#s(l)})}catch(e){return this.#n(e,l)}return e instanceof Promise?e.then(e=>e||(l.finalized?l.res:this.#s(l))).catch(e=>this.#n(e,l)):e??this.#s(l)}let h=(0,o.compose)(i[0],this.errorHandler,this.#s);return(async()=>{try{let e=await h(l);if(!e.finalized)throw Error("Context is not finalized. Did you forget to return a Response object or `await next()`?");return e.res}catch(e){return this.#n(e,l)}})()}fetch=(e,...t)=>this.#o(e,t[1],t[0],e.method);request=(e,t,r,s)=>e instanceof Request?this.fetch(t?new Request(e,t):e,r,s):(e=e.toString(),this.fetch(new Request(/^https?:\/\//.test(e)?e:`http://localhost${(0,h.mergePath)("/",e)}`,t),r,s));fire=()=>{addEventListener("fetch",e=>{e.respondWith(this.#o(e.request,e,void 0,e.request.method))})}}},{"./compose.js":"scXAs","./context.js":"7sFky","./router.js":"2P7Cv","./utils/constants.js":"htJPb","./utils/url.js":"lo13I","@parcel/transformer-js/src/esmodule-helpers.js":"dt6k9"}],scXAs:[function(e,t,r,s){var n=e("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(r),n.export(r,"compose",()=>o);var o=(e,t,r)=>(s,n)=>{let o=-1;return a(0);async function a(i){let l,h;if(i<=o)throw Error("next() called multiple times");o=i;let u=!1;if(e[i]?(h=e[i][0][0],s.req.routeIndex=i):h=i===e.length&&n||void 0,h)try{l=await h(s,()=>a(i+1))}catch(e){if(e instanceof Error&&t)s.error=e,l=await t(e,s),u=!0;else throw e}else!1===s.finalized&&r&&(l=await r(s));return l&&(!1===s.finalized||u)&&(s.res=l),s}}},{"@parcel/transformer-js/src/esmodule-helpers.js":"dt6k9"}],dt6k9:[function(e,t,r,s){r.interopDefault=function(e){return e&&e.__esModule?e:{default:e}},r.defineInteropFlag=function(e){Object.defineProperty(e,"__esModule",{value:!0})},r.exportAll=function(e,t){return Object.keys(e).forEach(function(r){"default"===r||"__esModule"===r||Object.prototype.hasOwnProperty.call(t,r)||Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[r]}})}),t},r.export=function(e,t,r){Object.defineProperty(e,t,{enumerable:!0,get:r})}},{}],"7sFky":[function(e,t,r,s){var n=e("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(r),n.export(r,"Context",()=>h),n.export(r,"TEXT_PLAIN",()=>i);var o=e("./request.js"),a=e("./utils/html.js"),i="text/plain; charset=UTF-8",l=(e,t={})=>{for(let r of Object.keys(t))e.set(r,t[r]);return e},h=class{#a;#i;env={};#l;finalized=!1;error;#h=200;#u;#d;#c;#p;#f=!0;#m;#j;#s;#g;#e;constructor(e,t){this.#a=e,t&&(this.#u=t.executionCtx,this.env=t.env,this.#s=t.notFoundHandler,this.#e=t.path,this.#g=t.matchResult)}get req(){return this.#i??=new(0,o.HonoRequest)(this.#a,this.#e,this.#g),this.#i}get event(){if(this.#u&&"respondWith"in this.#u)return this.#u;throw Error("This context has no FetchEvent")}get executionCtx(){if(this.#u)return this.#u;throw Error("This context has no ExecutionContext")}get res(){return this.#f=!1,this.#p||=new Response("404 Not Found",{status:404})}set res(e){if(this.#f=!1,this.#p&&e){for(let[t,r]of(e=new Response(e.body,e),this.#p.headers.entries()))if("content-type"!==t)if("set-cookie"===t){let t=this.#p.headers.getSetCookie();for(let r of(e.headers.delete("set-cookie"),t))e.headers.append("set-cookie",r)}else e.headers.set(t,r)}this.#p=e,this.finalized=!0}render=(...e)=>(this.#j??=e=>this.html(e),this.#j(...e));setLayout=e=>this.#m=e;getLayout=()=>this.#m;setRenderer=e=>{this.#j=e};header=(e,t,r)=>{if(this.finalized&&(this.#p=new Response(this.#p.body,this.#p)),void 0===t){this.#d?this.#d.delete(e):this.#c&&delete this.#c[e.toLocaleLowerCase()],this.finalized&&this.res.headers.delete(e);return}r?.append?(this.#d||(this.#f=!1,this.#d=new Headers(this.#c),this.#c={}),this.#d.append(e,t)):this.#d?this.#d.set(e,t):(this.#c??={},this.#c[e.toLowerCase()]=t),this.finalized&&(r?.append?this.res.headers.append(e,t):this.res.headers.set(e,t))};status=e=>{this.#f=!1,this.#h=e};set=(e,t)=>{this.#l??=new Map,this.#l.set(e,t)};get=e=>this.#l?this.#l.get(e):void 0;get var(){return this.#l?Object.fromEntries(this.#l):{}}#x(e,t,r){if(this.#f&&!r&&!t&&200===this.#h)return new Response(e,{headers:this.#c});if(t&&"number"!=typeof t){let r=new Headers(t.headers);return this.#d&&this.#d.forEach((e,t)=>{"set-cookie"===t?r.append(t,e):r.set(t,e)}),new Response(e,{headers:l(r,this.#c),status:t.status??this.#h})}let s="number"==typeof t?t:this.#h;for(let[e,t]of(this.#c??={},this.#d??=new Headers,l(this.#d,this.#c),this.#p&&(this.#p.headers.forEach((e,t)=>{"set-cookie"===t?this.#d?.append(t,e):this.#d?.set(t,e)}),l(this.#d,this.#c)),Object.entries(r??={})))if("string"==typeof t)this.#d.set(e,t);else for(let r of(this.#d.delete(e),t))this.#d.append(e,r);return new Response(e,{status:s,headers:this.#d})}newResponse=(...e)=>this.#x(...e);body=(e,t,r)=>"number"==typeof t?this.#x(e,t,r):this.#x(e,t);text=(e,t,r)=>{if(!this.#c){if(this.#f&&!r&&!t)return new Response(e);this.#c={}}return(this.#c["content-type"]=i,"number"==typeof t)?this.#x(e,t,r):this.#x(e,t)};json=(e,t,r)=>{let s=JSON.stringify(e);return this.#c??={},this.#c["content-type"]="application/json","number"==typeof t?this.#x(s,t,r):this.#x(s,t)};html=(e,t,r)=>(this.#c??={},this.#c["content-type"]="text/html; charset=UTF-8","object"==typeof e)?(0,a.resolveCallback)(e,a.HtmlEscapedCallbackPhase.Stringify,!1,{}).then(e=>"number"==typeof t?this.#x(e,t,r):this.#x(e,t)):"number"==typeof t?this.#x(e,t,r):this.#x(e,t);redirect=(e,t)=>(this.#d??=new Headers,this.#d.set("Location",String(e)),this.newResponse(null,t??302));notFound=()=>(this.#s??=()=>new Response,this.#s(this))}},{"./request.js":"jXU57","./utils/html.js":"dRgLc","@parcel/transformer-js/src/esmodule-helpers.js":"dt6k9"}],jXU57:[function(e,t,r,s){var n=e("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(r),n.export(r,"HonoRequest",()=>l);var o=e("./utils/body.js"),a=e("./utils/url.js"),i=e=>(0,a.tryDecode)(e,a.decodeURIComponent_),l=class{raw;#b;#g;routeIndex=0;path;bodyCache={};constructor(e,t="/",r=[[]]){this.raw=e,this.path=t,this.#g=r,this.#b={}}param(e){return e?this.#E(e):this.#y()}#E(e){let t=this.#g[0][this.routeIndex][1][e],r=this.#R(t);return r?/\%/.test(r)?i(r):r:void 0}#y(){let e={};for(let t of Object.keys(this.#g[0][this.routeIndex][1])){let r=this.#R(this.#g[0][this.routeIndex][1][t]);r&&"string"==typeof r&&(e[t]=/\%/.test(r)?i(r):r)}return e}#R(e){return this.#g[1]?this.#g[1][e]:e}query(e){return(0,a.getQueryParam)(this.url,e)}queries(e){return(0,a.getQueryParams)(this.url,e)}header(e){if(e)return this.raw.headers.get(e)??void 0;let t={};return this.raw.headers.forEach((e,r)=>{t[r]=e}),t}async parseBody(e){return this.bodyCache.parsedBody??=await (0,o.parseBody)(this,e)}#v=e=>{let{bodyCache:t,raw:r}=this,s=t[e];if(s)return s;let n=Object.keys(t)[0];return n?t[n].then(t=>("json"===n&&(t=JSON.stringify(t)),new Response(t)[e]())):t[e]=r[e]()};json(){return this.#v("json")}text(){return this.#v("text")}arrayBuffer(){return this.#v("arrayBuffer")}blob(){return this.#v("blob")}formData(){return this.#v("formData")}addValidatedData(e,t){this.#b[e]=t}valid(e){return this.#b[e]}get url(){return this.raw.url}get method(){return this.raw.method}get matchedRoutes(){return this.#g[0].map(([[,e]])=>e)}get routePath(){return this.#g[0].map(([[,e]])=>e)[this.routeIndex].path}}},{"./utils/body.js":"jXnid","./utils/url.js":"lo13I","@parcel/transformer-js/src/esmodule-helpers.js":"dt6k9"}],jXnid:[function(e,t,r,s){var n=e("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(r),n.export(r,"parseBody",()=>a);var o=e("../request.js"),a=async(e,t=Object.create(null))=>{let{all:r=!1,dot:s=!1}=t,n=(e instanceof o.HonoRequest?e.raw.headers:e.headers).get("Content-Type");return n?.startsWith("multipart/form-data")||n?.startsWith("application/x-www-form-urlencoded")?i(e,{all:r,dot:s}):{}};async function i(e,t){let r=await e.formData();return r?function(e,t){let r=Object.create(null);return e.forEach((e,s)=>{t.all||s.endsWith("[]")?l(r,s,e):r[s]=e}),t.dot&&Object.entries(r).forEach(([e,t])=>{e.includes(".")&&(h(r,e,t),delete r[e])}),r}(r,t):{}}var l=(e,t,r)=>{void 0!==e[t]?Array.isArray(e[t])?e[t].push(r):e[t]=[e[t],r]:e[t]=r},h=(e,t,r)=>{let s=e,n=t.split(".");n.forEach((e,t)=>{t===n.length-1?s[e]=r:((!s[e]||"object"!=typeof s[e]||Array.isArray(s[e])||s[e]instanceof File)&&(s[e]=Object.create(null)),s=s[e])})}},{"../request.js":"jXU57","@parcel/transformer-js/src/esmodule-helpers.js":"dt6k9"}],lo13I:[function(e,t,r,s){var n=e("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(r),n.export(r,"checkOptionalParameter",()=>g),n.export(r,"decodeURIComponent_",()=>R),n.export(r,"getPath",()=>p),n.export(r,"getPathNoStrict",()=>m),n.export(r,"getPattern",()=>u),n.export(r,"getQueryParam",()=>E),n.export(r,"getQueryParams",()=>y),n.export(r,"getQueryStrings",()=>f),n.export(r,"mergePath",()=>j),n.export(r,"splitPath",()=>o),n.export(r,"splitRoutingPath",()=>a),n.export(r,"tryDecode",()=>d);var o=e=>{let t=e.split("/");return""===t[0]&&t.shift(),t},a=e=>{let{groups:t,path:r}=i(e);return l(o(r),t)},i=e=>{let t=[];return e=e.replace(/\{[^}]+\}/g,(e,r)=>{let s=`@${r}`;return t.push([s,e]),s}),{groups:t,path:e}},l=(e,t)=>{for(let r=t.length-1;r>=0;r--){let[s]=t[r];for(let n=e.length-1;n>=0;n--)if(e[n].includes(s)){e[n]=e[n].replace(s,t[r][1]);break}}return e},h={},u=(e,t)=>{if("*"===e)return"*";let r=e.match(/^\:([^\{\}]+)(?:\{(.+)\})?$/);if(r){let s=`${e}#${t}`;return h[s]||(r[2]?h[s]=t&&":"!==t[0]&&"*"!==t[0]?[s,r[1],RegExp(`^${r[2]}(?=/${t})`)]:[e,r[1],RegExp(`^${r[2]}$`)]:h[s]=[e,r[1],!0]),h[s]}return null},d=(e,t)=>{try{return t(e)}catch{return e.replace(/(?:%[0-9A-Fa-f]{2})+/g,e=>{try{return t(e)}catch{return e}})}},c=e=>d(e,decodeURI),p=e=>{let t=e.url,r=t.indexOf("/",8),s=r;for(;s<t.length;s++){let e=t.charCodeAt(s);if(37===e){let e=t.indexOf("?",s),n=t.slice(r,-1===e?void 0:e);return c(n.includes("%25")?n.replace(/%25/g,"%2525"):n)}if(63===e)break}return t.slice(r,s)},f=e=>{let t=e.indexOf("?",8);return -1===t?"":"?"+e.slice(t+1)},m=e=>{let t=p(e);return t.length>1&&"/"===t.at(-1)?t.slice(0,-1):t},j=(e,t,...r)=>(r.length&&(t=j(t,...r)),`${e?.[0]==="/"?"":"/"}${e}${"/"===t?"":`${e?.at(-1)==="/"?"":"/"}${t?.[0]==="/"?t.slice(1):t}`}`),g=e=>{if(63!==e.charCodeAt(e.length-1)||!e.includes(":"))return null;let t=e.split("/"),r=[],s="";return t.forEach(e=>{if(""===e||/\:/.test(e)){if(/\:/.test(e))if(/\?/.test(e)){0===r.length&&""===s?r.push("/"):r.push(s);let t=e.replace("?","");s+="/"+t,r.push(s)}else s+="/"+e}else s+="/"+e}),r.filter((e,t,r)=>r.indexOf(e)===t)},x=e=>/[%+]/.test(e)?(-1!==e.indexOf("+")&&(e=e.replace(/\+/g," ")),-1!==e.indexOf("%")?R(e):e):e,b=(e,t,r)=>{let s;if(!r&&t&&!/[%+]/.test(t)){let r=e.indexOf(`?${t}`,8);for(-1===r&&(r=e.indexOf(`&${t}`,8));-1!==r;){let s=e.charCodeAt(r+t.length+1);if(61===s){let s=r+t.length+2,n=e.indexOf("&",s);return x(e.slice(s,-1===n?void 0:n))}if(38==s||isNaN(s))return"";r=e.indexOf(`&${t}`,r+1)}if(!(s=/[%+]/.test(e)))return}let n={};s??=/[%+]/.test(e);let o=e.indexOf("?",8);for(;-1!==o;){let t,a=e.indexOf("&",o+1),i=e.indexOf("=",o);i>a&&-1!==a&&(i=-1);let l=e.slice(o+1,-1===i?-1===a?void 0:a:i);s&&(l=x(l)),o=a,""!==l&&(-1===i?t="":(t=e.slice(i+1,-1===a?void 0:a),s&&(t=x(t))),r?(n[l]&&Array.isArray(n[l])||(n[l]=[]),n[l].push(t)):n[l]??=t)}return t?n[t]:n},E=b,y=(e,t)=>b(e,t,!0),R=decodeURIComponent},{"@parcel/transformer-js/src/esmodule-helpers.js":"dt6k9"}],dRgLc:[function(e,t,r,s){var n=e("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(r),n.export(r,"HtmlEscapedCallbackPhase",()=>o),n.export(r,"escapeToBuffer",()=>h),n.export(r,"raw",()=>a),n.export(r,"resolveCallback",()=>d),n.export(r,"resolveCallbackSync",()=>u),n.export(r,"stringBufferToString",()=>l);var o={Stringify:1,BeforeStream:2,Stream:3},a=(e,t)=>{let r=new String(e);return r.isEscaped=!0,r.callbacks=t,r},i=/[&<>'"]/,l=async(e,t)=>{let r="";t||=[];let s=await Promise.all(e);for(let e=s.length-1;r+=s[e],!(--e<0);e--){let n=s[e];"object"==typeof n&&t.push(...n.callbacks||[]);let o=n.isEscaped;if("object"==typeof(n=await ("object"==typeof n?n.toString():n))&&t.push(...n.callbacks||[]),n.isEscaped??o)r+=n;else{let e=[r];h(n,e),r=e[0]}}return a(r,t)},h=(e,t)=>{let r,s,n=e.search(i);if(-1===n){t[0]+=e;return}let o=0;for(s=n;s<e.length;s++){switch(e.charCodeAt(s)){case 34:r="&quot;";break;case 39:r="&#39;";break;case 38:r="&amp;";break;case 60:r="&lt;";break;case 62:r="&gt;";break;default:continue}t[0]+=e.substring(o,s)+r,o=s+1}t[0]+=e.substring(o,s)},u=e=>{let t=e.callbacks;if(!t?.length)return e;let r=[e],s={};return t.forEach(e=>e({phase:o.Stringify,buffer:r,context:s})),r[0]},d=async(e,t,r,s,n)=>{"object"==typeof e&&!(e instanceof String)&&(e instanceof Promise||(e=e.toString()),e instanceof Promise&&(e=await e));let o=e.callbacks;if(!o?.length)return Promise.resolve(e);n?n[0]+=e:n=[e];let i=Promise.all(o.map(e=>e({phase:t,buffer:n,context:s}))).then(e=>Promise.all(e.filter(Boolean).map(e=>d(e,t,!1,s,n))).then(()=>n[0]));return r?a(await i,o):i}},{"@parcel/transformer-js/src/esmodule-helpers.js":"dt6k9"}],"2P7Cv":[function(e,t,r,s){var n=e("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(r),n.export(r,"MESSAGE_MATCHER_IS_ALREADY_BUILT",()=>l),n.export(r,"METHODS",()=>i),n.export(r,"METHOD_NAME_ALL",()=>o),n.export(r,"METHOD_NAME_ALL_LOWERCASE",()=>a),n.export(r,"UnsupportedPathError",()=>h);var o="ALL",a="all",i=["get","post","put","delete","options","patch"],l="Can not add a route since the matcher is already built.",h=class extends Error{}},{"@parcel/transformer-js/src/esmodule-helpers.js":"dt6k9"}],htJPb:[function(e,t,r,s){var n=e("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(r),n.export(r,"COMPOSED_HANDLER",()=>o);var o="__COMPOSED_HANDLER"},{"@parcel/transformer-js/src/esmodule-helpers.js":"dt6k9"}],g63tS:[function(e,t,r,s){var n=e("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(r),n.export(r,"RegExpRouter",()=>o.RegExpRouter);var o=e("./router.js")},{"./router.js":"eTSHg","@parcel/transformer-js/src/esmodule-helpers.js":"dt6k9"}],eTSHg:[function(e,t,r,s){var n=e("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(r),n.export(r,"RegExpRouter",()=>f);var o=e("../../router.js"),a=e("../../utils/url.js"),i=e("./node.js"),l=e("./trie.js"),h=[],u=[/^$/,[],Object.create(null)],d=Object.create(null);function c(e){return d[e]??=new RegExp("*"===e?"":`^${e.replace(/\/\*$|([.\\+*[^\]$()])/g,(e,t)=>t?`\\${t}`:"(?:|/.*)")}$`)}function p(e,t){if(e){for(let r of Object.keys(e).sort((e,t)=>t.length-e.length))if(c(r).test(t))return[...e[r]]}}var f=class{name="RegExpRouter";#w;#O;constructor(){this.#w={[o.METHOD_NAME_ALL]:Object.create(null)},this.#O={[o.METHOD_NAME_ALL]:Object.create(null)}}add(e,t,r){let s=this.#w,n=this.#O;if(!s||!n)throw Error(o.MESSAGE_MATCHER_IS_ALREADY_BUILT);s[e]||[s,n].forEach(t=>{t[e]=Object.create(null),Object.keys(t[o.METHOD_NAME_ALL]).forEach(r=>{t[e][r]=[...t[o.METHOD_NAME_ALL][r]]})}),"/*"===t&&(t="*");let i=(t.match(/\/:/g)||[]).length;if(/\*$/.test(t)){let a=c(t);e===o.METHOD_NAME_ALL?Object.keys(s).forEach(e=>{s[e][t]||=p(s[e],t)||p(s[o.METHOD_NAME_ALL],t)||[]}):s[e][t]||=p(s[e],t)||p(s[o.METHOD_NAME_ALL],t)||[],Object.keys(s).forEach(t=>{(e===o.METHOD_NAME_ALL||e===t)&&Object.keys(s[t]).forEach(e=>{a.test(e)&&s[t][e].push([r,i])})}),Object.keys(n).forEach(t=>{(e===o.METHOD_NAME_ALL||e===t)&&Object.keys(n[t]).forEach(e=>a.test(e)&&n[t][e].push([r,i]))});return}let l=(0,a.checkOptionalParameter)(t)||[t];for(let t=0,a=l.length;t<a;t++){let h=l[t];Object.keys(n).forEach(l=>{(e===o.METHOD_NAME_ALL||e===l)&&(n[l][h]||=[...p(s[l],h)||p(s[o.METHOD_NAME_ALL],h)||[]],n[l][h].push([r,i-a+t+1]))})}}match(e,t){d=Object.create(null);let r=this.#H();return this.match=(e,t)=>{let s=r[e]||r[o.METHOD_NAME_ALL],n=s[2][t];if(n)return n;let a=t.match(s[0]);if(!a)return[[],h];let i=a.indexOf("",1);return[s[1][i],a]},this.match(e,t)}#H(){let e=Object.create(null);return Object.keys(this.#O).concat(Object.keys(this.#w)).forEach(t=>{e[t]||=this.#A(t)}),this.#w=this.#O=void 0,e}#A(e){let t=[],r=e===o.METHOD_NAME_ALL;return([this.#w,this.#O].forEach(s=>{let n=s[e]?Object.keys(s[e]).map(t=>[t,s[e][t]]):[];0!==n.length?(r||=!0,t.push(...n)):e!==o.METHOD_NAME_ALL&&t.push(...Object.keys(s[o.METHOD_NAME_ALL]).map(e=>[e,s[o.METHOD_NAME_ALL][e]]))}),r)?function(e){let t=new(0,l.Trie),r=[];if(0===e.length)return u;let s=e.map(e=>[!/\*|\/:/.test(e[0]),...e]).sort(([e,t],[r,s])=>e?1:r?-1:t.length-s.length),n=Object.create(null);for(let e=0,a=-1,l=s.length;e<l;e++){let l,[u,d,c]=s[e];u?n[d]=[c.map(([e])=>[e,Object.create(null)]),h]:a++;try{l=t.insert(d,a,u)}catch(e){throw e===i.PATH_ERROR?new(0,o.UnsupportedPathError)(d):e}u||(r[a]=c.map(([e,t])=>{let r=Object.create(null);for(t-=1;t>=0;t--){let[e,s]=l[t];r[e]=s}return[e,r]}))}let[a,d,c]=t.buildRegExp();for(let e=0,t=r.length;e<t;e++)for(let t=0,s=r[e].length;t<s;t++){let s=r[e][t]?.[1];if(!s)continue;let n=Object.keys(s);for(let e=0,t=n.length;e<t;e++)s[n[e]]=c[s[n[e]]]}let p=[];for(let e in d)p[e]=r[d[e]];return[a,p,n]}(t):null}}},{"../../router.js":"2P7Cv","../../utils/url.js":"lo13I","./node.js":"7pXuX","./trie.js":"fYg0f","@parcel/transformer-js/src/esmodule-helpers.js":"dt6k9"}],"7pXuX":[function(e,t,r,s){var n=e("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(r),n.export(r,"Node",()=>u),n.export(r,"PATH_ERROR",()=>i);var o="[^/]+",a="(?:|/.*)",i=Symbol(),l=new Set(".\\+*[^]$()");function h(e,t){return 1===e.length?1===t.length?e<t?-1:1:-1:1===t.length||".*"===e||e===a?1:".*"===t||t===a?-1:e===o?1:t===o?-1:e.length===t.length?e<t?-1:1:t.length-e.length}var u=class{#_;#k;#P=Object.create(null);insert(e,t,r,s,n){let l;if(0===e.length){if(void 0!==this.#_)throw i;if(n)return;this.#_=t;return}let[h,...d]=e,c="*"===h?0===d.length?["","",".*"]:["","",o]:"/*"===h?["","",a]:h.match(/^\:([^\{\}]+)(?:\{(.+)\})?$/);if(c){let e=c[1],t=c[2]||o;if(e&&c[2]&&(t=t.replace(/^\((?!\?:)(?=[^)]+\)$)/,"(?:"),/\((?!\?:)/.test(t)))throw i;if(!(l=this.#P[t])){if(Object.keys(this.#P).some(e=>".*"!==e&&e!==a))throw i;if(n)return;l=this.#P[t]=new u,""!==e&&(l.#k=s.varIndex++)}n||""===e||r.push([e,l.#k])}else if(!(l=this.#P[h])){if(Object.keys(this.#P).some(e=>e.length>1&&".*"!==e&&e!==a))throw i;if(n)return;l=this.#P[h]=new u}l.insert(d,t,r,s,n)}buildRegExpStr(){let e=Object.keys(this.#P).sort(h).map(e=>{let t=this.#P[e];return("number"==typeof t.#k?`(${e})@${t.#k}`:l.has(e)?`\\${e}`:e)+t.buildRegExpStr()});return("number"==typeof this.#_&&e.unshift(`#${this.#_}`),0===e.length)?"":1===e.length?e[0]:"(?:"+e.join("|")+")"}}},{"@parcel/transformer-js/src/esmodule-helpers.js":"dt6k9"}],fYg0f:[function(e,t,r,s){var n=e("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(r),n.export(r,"Trie",()=>a);var o=e("./node.js"),a=class{#L={varIndex:0};#M=new(0,o.Node);insert(e,t,r){let s=[],n=[];for(let t=0;;){let r=!1;if(e=e.replace(/\{[^}]+\}/g,e=>{let s=`@\\${t}`;return n[t]=[s,e],t++,r=!0,s}),!r)break}let o=e.match(/(?::[^\/]+)|(?:\/\*$)|./g)||[];for(let e=n.length-1;e>=0;e--){let[t]=n[e];for(let r=o.length-1;r>=0;r--)if(-1!==o[r].indexOf(t)){o[r]=o[r].replace(t,n[e][1]);break}}return this.#M.insert(o,t,s,this.#L,r),s}buildRegExp(){let e=this.#M.buildRegExpStr();if(""===e)return[/^$/,[],[]];let t=0,r=[],s=[];return e=e.replace(/#(\d+)|@(\d+)|\.\*\$/g,(e,n,o)=>void 0!==n?(r[++t]=Number(n),"$()"):(void 0!==o&&(s[Number(o)]=++t),"")),[RegExp(`^${e}`),r,s]}}},{"./node.js":"7pXuX","@parcel/transformer-js/src/esmodule-helpers.js":"dt6k9"}],"7xsbc":[function(e,t,r,s){var n=e("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(r),n.export(r,"SmartRouter",()=>o.SmartRouter);var o=e("./router.js")},{"./router.js":"b28IK","@parcel/transformer-js/src/esmodule-helpers.js":"dt6k9"}],b28IK:[function(e,t,r,s){var n=e("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(r),n.export(r,"SmartRouter",()=>a);var o=e("../../router.js"),a=class{name="SmartRouter";#S=[];#O=[];constructor(e){this.#S=e.routers}add(e,t,r){if(!this.#O)throw Error(o.MESSAGE_MATCHER_IS_ALREADY_BUILT);this.#O.push([e,t,r])}match(e,t){let r;if(!this.#O)throw Error("Fatal error");let s=this.#S,n=this.#O,a=s.length,i=0;for(;i<a;i++){let a=s[i];try{for(let e=0,t=n.length;e<t;e++)a.add(...n[e]);r=a.match(e,t)}catch(e){if(e instanceof o.UnsupportedPathError)continue;throw e}this.match=a.match.bind(a),this.#S=[a],this.#O=void 0;break}if(i===a)throw Error("Fatal error");return this.name=`SmartRouter + ${this.activeRouter.name}`,r}get activeRouter(){if(this.#O||1!==this.#S.length)throw Error("No active router has been determined yet.");return this.#S[0]}}},{"../../router.js":"2P7Cv","@parcel/transformer-js/src/esmodule-helpers.js":"dt6k9"}],"3vG3W":[function(e,t,r,s){var n=e("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(r),n.export(r,"TrieRouter",()=>o.TrieRouter);var o=e("./router.js")},{"./router.js":"9qF44","@parcel/transformer-js/src/esmodule-helpers.js":"dt6k9"}],"9qF44":[function(e,t,r,s){var n=e("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(r),n.export(r,"TrieRouter",()=>i);var o=e("../../utils/url.js"),a=e("./node.js"),i=class{name="TrieRouter";#F;constructor(){this.#F=new(0,a.Node)}add(e,t,r){let s=(0,o.checkOptionalParameter)(t);if(s){for(let t=0,n=s.length;t<n;t++)this.#F.insert(e,s[t],r);return}this.#F.insert(e,t,r)}match(e,t){return this.#F.search(e,t)}}},{"../../utils/url.js":"lo13I","./node.js":"21HVx","@parcel/transformer-js/src/esmodule-helpers.js":"dt6k9"}],"21HVx":[function(e,t,r,s){var n=e("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(r),n.export(r,"Node",()=>l);var o=e("../../router.js"),a=e("../../utils/url.js"),i=Object.create(null),l=class{#D;#P;#I;#T=0;#C=i;constructor(e,t,r){if(this.#P=r||Object.create(null),this.#D=[],e&&t){let r=Object.create(null);r[e]={handler:t,possibleKeys:[],score:0},this.#D=[r]}this.#I=[]}insert(e,t,r){this.#T=++this.#T;let s=this,n=(0,a.splitRoutingPath)(t),o=[];for(let e=0,t=n.length;e<t;e++){let t=n[e],r=n[e+1],i=(0,a.getPattern)(t,r),h=Array.isArray(i)?i[0]:t;if(Object.keys(s.#P).includes(h)){s=s.#P[h];let e=(0,a.getPattern)(t,r);e&&o.push(e[1]);continue}s.#P[h]=new l,i&&(s.#I.push(i),o.push(i[1])),s=s.#P[h]}let i=Object.create(null),h={handler:r,possibleKeys:o.filter((e,t,r)=>r.indexOf(e)===t),score:this.#T};return i[e]=h,s.#D.push(i),s}#N(e,t,r,s){let n=[];for(let a=0,l=e.#D.length;a<l;a++){let l=e.#D[a],h=l[t]||l[o.METHOD_NAME_ALL],u={};if(void 0!==h&&(h.params=Object.create(null),n.push(h),r!==i||s&&s!==i))for(let e=0,t=h.possibleKeys.length;e<t;e++){let t=h.possibleKeys[e],n=u[h.score];h.params[t]=s?.[t]&&!n?s[t]:r[t]??s?.[t],u[h.score]=!0}}return n}search(e,t){let r=[];this.#C=i;let s=[this],n=(0,a.splitPath)(t),o=[];for(let t=0,a=n.length;t<a;t++){let l=n[t],h=t===a-1,u=[];for(let a=0,d=s.length;a<d;a++){let d=s[a],c=d.#P[l];c&&(c.#C=d.#C,h?(c.#P["*"]&&r.push(...this.#N(c.#P["*"],e,d.#C)),r.push(...this.#N(c,e,d.#C))):u.push(c));for(let s=0,a=d.#I.length;s<a;s++){let a=d.#I[s],c=d.#C===i?{}:{...d.#C};if("*"===a){let t=d.#P["*"];t&&(r.push(...this.#N(t,e,d.#C)),t.#C=c,u.push(t));continue}if(""===l)continue;let[p,f,m]=a,j=d.#P[p],g=n.slice(t).join("/");if(m instanceof RegExp){let t=m.exec(g);if(t){if(c[f]=t[0],r.push(...this.#N(j,e,d.#C,c)),Object.keys(j.#P).length){j.#C=c;let e=t[0].match(/\//)?.length??0;(o[e]||=[]).push(j)}continue}}(!0===m||m.test(l))&&(c[f]=l,h?(r.push(...this.#N(j,e,c,d.#C)),j.#P["*"]&&r.push(...this.#N(j.#P["*"],e,c,d.#C))):(j.#C=c,u.push(j)))}}s=u.concat(o.shift()??[])}return r.length>1&&r.sort((e,t)=>e.score-t.score),[r.map(({handler:e,params:t})=>[e,t])]}}},{"../../router.js":"2P7Cv","../../utils/url.js":"lo13I","@parcel/transformer-js/src/esmodule-helpers.js":"dt6k9"}],"6Gli9":[function(e,t,r,s){var n=e("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(r),n.export(r,"FOO",()=>o);let o="BAR"},{"@parcel/transformer-js/src/esmodule-helpers.js":"dt6k9"}]},["dDS2A"],"dDS2A","parcelRequire375b",{});let{default:e}=parcelRequire375b("dDS2A");export{e as default};
//# sourceMappingURL=index.js.map
